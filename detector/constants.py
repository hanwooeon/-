"""
Constants used across the keyword detection module.
"""

# 별칭 매핑 (정규식/문자열 변형)
ALIAS_MAPPINGS = [
    (r'디\s*비', 'db'),
    (r'아이\s*디', 'id'),
    (r'카카오\s*톡', '카톡'),
]

# 구분자 정규식 패턴
SEPARATOR_PATTERN = r'[\s\-\_\/\.\,\·]+'

# 부분 키워드 추출을 위한 구분자 패턴들
KEYWORD_SEPARATORS = [
    r'DB|디비|D\.?B', 
    r'ID|아이디|I\.?D', 
    r'판매|삽니다|팝니다', 
    r'해킹|의뢰|대행', 
    r'통장|장'
]

# 의미있는 키워드 패턴들 (동적 부분 키워드 추출용)
MEANINGFUL_PATTERNS = [
    r'[가-힣]{2,}(?=DB|디비)',          # DB 앞의 한글 2글자 이상
    r'(?:네이버|다음|홍보용)',           # 플랫폼명
    r'(?:부결|완콜|전날|실시간|문자|내구재|토토|주식|막)',  # 핵심 키워드
    r'(?:대포|법인)',                   # 통장 관련
    r'(?:카톡|디비|DDos)(?=해킹)',       # 해킹 앞부분
]

# DB 관련 키워드 정확 매칭 패턴들
DB_PATTERNS = [
    r'부결\s*(?:db|디비|d\.?b)',
    r'완콜\s*(?:db|디비|d\.?b)', 
    r'전날\s*(?:db|디비|d\.?b)',
    r'실시간\s*(?:db|디비|d\.?b)',
    r'문자\s*(?:db|디비|d\.?b)',
    r'내구재\s*(?:db|디비|d\.?b)',
    r'토토\s*(?:db|디비|d\.?b)',
    r'주식\s*(?:db|디비|d\.?b)',
    r'막\s*(?:db|디비|d\.?b)',
    r'대출\s*(?:db|디비|d\.?b)'
]

# 계정 거래 관련 키워드 패턴들
ACCOUNT_PATTERNS = [
    r'(?:네이버|다음|홍보용)\s*(?:아이디|id)\s*(?:판매|삽니다)',
    r'계정\s*판매',
    r'최적화\s*(?:id|아이디)',
    r'네이버\s*(?:실명|비실명)',
    # 더 유연한 패턴들
    r'네이버.*?아이디.*?판매',
    r'다음.*?아이디.*?판매'
]

# 통장/계좌 관련 키워드 패턴들
BANK_PATTERNS = [
    r'대포\s*통장\s*(?:팝니다|매입|구매)',
    r'통장\s*(?:매입|구매|판매|팝니다)',
    r'(?:법인|개인)\s*장\s*(?:판매|팝니다)',
    r'(?:장집|오다집)'
]

# 해킹 관련 키워드 패턴들
HACKING_PATTERNS = [
    r'(?:카톡|카카오톡)\s*해킹(?:\s*의뢰)?',
    r'디비\s*해킹',
    r'ddos\s*해킹',
    r'(?:스마트폰|핸드폰)\s*해킹',
    r'인스타(?:그램)?(?:\s*디엠)?\s*해킹'
]

# 카테고리별 필수 지표 단어
REQUIRED_INDICATORS = {
    "personal_db": [
        '판매', '구매', '삽니다', '팝니다', '매입', 
        '가격', '문의', '연락', '저렴', '급매', '급구'
    ],
    "account_trade": [
        '판매', '구매', '삽니다', '팝니다', '가격', 
        '문의', '연락', '거래', '저렴'
    ],
    "bank_account": [
        '판매', '구매', '삽니다', '팝니다', '매입', 
        '가격', '문의', '연락', '거래'
    ],
    "hacking": [
        '의뢰', '대행', '문의', '연락', '가격', 
        '서비스', '업체'
    ]
}

# 거래 의도를 나타내는 키워드
TRADE_INDICATORS = ['판매', '구매', '삽니다', '팝니다', '매입']

# 합법적 사용을 나타내는 부정 지표들 (더 구체적으로)
NEGATIVE_INDICATORS = [
    '방지', '차단', '필터링', '검출', '탐지', '보안솔루션', '예방', 
    '교육', '주의사항', '신고', '제재', '처벌', '금지', '불법행위', '위험성',
    '뉴스', '기사', '보도', '분석', '연구', '논문', '경고'
]

# 카테고리별 패턴 매핑
CATEGORY_PATTERNS = {
    "personal_db": DB_PATTERNS,
    "account_trade": ACCOUNT_PATTERNS,
    "bank_account": BANK_PATTERNS,
    "hacking": HACKING_PATTERNS
}

# DB/디비 변형 패턴들
DB_VARIANT_PATTERNS = ['DB', '디비', 'D.B', 'D B']
ID_VARIANT_PATTERNS = ['ID', '아이디', 'I.D', 'I D']